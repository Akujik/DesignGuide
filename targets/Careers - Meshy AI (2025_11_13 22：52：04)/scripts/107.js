try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c75d102a-e64b-4678-8eec-5ff093302d2d",e._sentryDebugIdIdentifier="sentry-dbid-c75d102a-e64b-4678-8eec-5ff093302d2d")}()}catch(e){}!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[(new e.Error).stack]=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];if(null!=r)for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])}return e}({},e._sentryModuleMetadata[(new e.Error).stack],{"_sentryBundlerPluginAppKey:bWVzaHktd2ViYXBwLSMx":!0})}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1205],{9285:(e,t,r)=>{r.d(t,{_$:()=>i,rr:()=>l});var a=r(12526),n=r(75731);r(82641);let o={isWireframe:!1,isSolidModeWithNormalMap:!1,isShowGrid:!1,isShowStatistics:!0,isAutoRotate:!1,environmentStrength:1.75,isShowBackground:!1,isAutoRotateBackground:!1,backgroundRotation:0,previewRenderMode:"pbr",customHDRIUrl:void 0,renderingSolidSnapshot:!1,isRigging:!1,isDisplaySkeletal:!1,isDisplayAnimation:!0},l=(0,n.vt)((e,t)=>({...o,reset(){e(o)}})),i=e=>{let t=(0,a.IN)(),r=l.getState().isShowGrid;"animate"===e.phase?(t.isAlbedoMode||t.isSolidMode||(0,a.wU)(),r||l.setState({isShowGrid:!0})):r&&l.setState({isShowGrid:!1})}},12526:(e,t,r)=>{r.d(t,{BF:()=>d,IN:()=>p,eI:()=>i,tM:()=>u,wU:()=>s});var a=r(9285),n=r(55182),o=r(12115),l=r(66027);let i=()=>{a.rr.setState({previewRenderMode:"solid",isAutoRotateBackground:!1})},s=()=>{a.rr.setState({previewRenderMode:"color",isAutoRotateBackground:!1}),n.Y.setState({viewSwitcherViewId:n.r.COLOR_MAP})},u=()=>{n.Y.setState({viewSwitcherViewId:n.r.MODEL_VIEW}),a.rr.setState({previewRenderMode:"pbr",isAutoRotateBackground:!1})},c=e=>{let{viewSwitcherViewId:t,previewRenderMode:r}=e,a=Object.values(n.r).includes(t)&&t!==n.r.MODEL_VIEW;return{isSolidMode:"solid"===r,isAlbedoMode:"color"===r&&a,isPBRShadingMode:"pbr"===r}},d=()=>{let e=(0,n.Y)(e=>e.viewSwitcherViewId),{previewRenderMode:t}=(0,a.rr)((0,l.k)(e=>({previewRenderMode:e.previewRenderMode})));return(0,o.useMemo)(()=>c({viewSwitcherViewId:e,previewRenderMode:t}),[e,t])},p=()=>{let e=n.Y.getState(),t=a.rr.getState();return c({viewSwitcherViewId:e.viewSwitcherViewId,previewRenderMode:t.previewRenderMode})}},49779:(e,t,r)=>{r.d(t,{Dq:()=>o,du:()=>n,io:()=>l,u_:()=>a});let a=[12,5.8,-12],n=[10,4.8,10],o=[0,2,0],l=30},81205:(e,t,r)=>{r.d(t,{w:()=>eo,A:()=>eu});var a=r(95155),n=r(74765),o=r(93800),l=r(880),i=r(9285),s=r(41137),u=r(30258),c=r(8952),d=r(27122),p=r(69095),m=r(8983),f=r(18955),h=r(15239),g=r(12115),v=r(27987),M=r(87548),x=r(75951),b=r(53531),w=r(67140),S=r(73063);let y=(0,g.createContext)({}),R=e=>{e.onBeforeCompile=e=>{e.fragmentShader=e.fragmentShader.replace("#include <clipping_planes_pars_fragment>","#include <clipping_planes_pars_fragment>\n  float hash12(vec2 p) {\n    return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n  }"),e.fragmentShader=e.fragmentShader.replace("vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;","vec2 vUv = gl_FragCoord.xy;\n        float noise = hash12(vUv * 0.001 * 3.152);\n        vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.494 + 0.5 + 0.005 * noise;")}};var E=r(88120);let C=new M.MeshStandardMaterial({color:0xffffff}),j=new M.MeshBasicMaterial({color:0xffffff}),A=e=>{let{invalidate:t}=(0,S.A)();(0,S.C)((e,r)=>{t()});let r=(0,x.zo)("https://cdn.meshy.ai/webapp-assets/viewer/matcap/basic_MeshyFinal_Grey.jpg"),n=(0,g.useMemo)(()=>{let e=new M.MeshMatcapMaterial({color:0xa9a9a9,matcap:r,side:M.DoubleSide});return R(e),e},[r]),{skeletonModelUrl:o,animationModelUrl:l}=e,{isDisplayAnimation:s,isDisplaySkeletal:u,previewRenderMode:c}=(0,i.rr)(),{mode:d}=(0,g.useContext)(y),p="color"!==c,m="animation-publish"!==d&&"solid"===c,{scene:f,animations:h,materials:v}=(0,b.p)(null!=o?o:""),A=(0,g.useMemo)(()=>E.o8(f),[f]),{mixer:k,clips:U}=(0,w.f)(h,A);(0,g.useEffect)(()=>{Object.values(v).forEach(e=>{e.depthTest=!1,e.depthWrite=!1,e.roughness=1,e.emissive.set(0xc5f955).convertSRGBToLinear(),e.color.set(0)})},[v]);let{materials:_,animations:O,scene:T}=(0,b.p)(null!=l?l:""),I=(0,g.useMemo)(()=>E.o8(T),[T]),{mixer:B,clips:D}=(0,w.f)(O,I),P=(0,g.useMemo)(()=>{I.scale.set(1,1,1),I.updateMatrixWorld();let e=new M.Box3().setFromObject(I).getSize(new M.Vector3);return 5/Math.max(e.x,e.y,e.z)},[I]),L=(0,g.useMemo)(()=>P*(s?.9:1),[P,s]),N=(0,g.useRef)(void 0),W=(0,g.useRef)(void 0);(0,g.useEffect)(()=>{let e=B.clipAction(D[0]);e.loop=M.LoopRepeat,e.play(),N.current=e;let t=k.clipAction(U[0]);t.loop=M.LoopRepeat,t.play(),W.current=t},[D,U,B,k]),(0,g.useEffect)(()=>{i.rr.setState({isDisplayAnimation:!0})},[l]),(0,g.useEffect)(()=>{var e,t,r,a;s?(null==(e=N.current)||e.play(),null==(t=W.current)||t.play()):(null==(r=N.current)||r.stop(),null==(a=W.current)||a.stop())},[s]),(0,g.useEffect)(()=>{W.current&&N.current&&(W.current.time=N.current.time)},[u,s]);let V=(0,g.useMemo)(()=>{if(m)return n;let e=Object.values(_)[0];return e instanceof M.MeshStandardMaterial&&(!(e instanceof M.MeshStandardMaterial)||e.map)?(e.map&&(e.map.needsUpdate=!0),p)?(C.vertexColors=!e.map,C.flatShading=!e.map,C.map=e.map,C.metalnessMap=e.metalnessMap,C.roughnessMap=e.roughnessMap,C.roughness=1,C.metalness=1,C.normalMap=e.normalMap,C.needsUpdate=!0,C):(j.vertexColors=!e.map,j.map=e.map,j.needsUpdate=!0,j):n},[p,m,_,n]);return(0,g.useEffect)(()=>{I.traverse(e=>{e.isMesh&&(e.material=V)})},[V,I]),(0,g.useEffect)(()=>{I.traverse(e=>{e.isMesh&&(e.frustumCulled=!1)}),A.traverse(e=>{e.isMesh&&(e.frustumCulled=!1)})},[I,A]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("primitive",{object:I,scale:L,renderOrder:10}),(0,a.jsx)("primitive",{object:A,scale:L,renderOrder:15,visible:u&&"animation-publish"!==d})]})},k=()=>{let{isShowBackground:e,previewRenderMode:t}=(0,i.rr)(),{mode:r}=(0,g.useContext)(y),a=["workspace","showcase","animation","animation-preview"].includes(r);return e&&a&&"color"!==t},U=new M.RawShaderMaterial({depthWrite:!1,depthTest:!1,side:M.BackSide,uniforms:{uResolution:{value:new M.Vector2},uTime:{value:0},uRadius:{value:1},uSmooth:{value:.98},uNoise:{value:.02},uBgColor1:{value:new M.Color("#181818")},uBgColor2:{value:new M.Color("#36393e")}},vertexShader:"\nprecision highp float;\nattribute vec3 position;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nattribute vec2 uv;\nvoid main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1. );\n}\n  ",fragmentShader:"\nprecision highp float;\n\nuniform vec2 uResolution;\nuniform float uTime;\nuniform float uSmooth;\nuniform float uRadius;\nuniform float uNoise;\nuniform vec3 uBgColor1;\nuniform vec3 uBgColor2;\n\nfloat hash12(vec2 p) {\n  return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main() {\n  vec2 aspect = uResolution.xy / uResolution.yy;\n  vec2 vUv = gl_FragCoord.xy / uResolution.xy;\n  // sphere\n  vec2 sphereUv = (vUv * 2.0 - 1.0) * aspect;\n  float sphere = smoothstep(uRadius, uRadius - uSmooth, length(sphereUv));\n  vec3 outgo = mix(uBgColor1, uBgColor2, sphere);\n  // noise\n  float noise = hash12(vUv * 3.152);\n  outgo.xyz += vec3((noise - 0.5) * uNoise * max(sphere, 0.0));\n  gl_FragColor = vec4(outgo, 1.);\n}\n"}),_=e=>{let{viewport:t,size:r,invalidate:n}=(0,S.A)();(0,g.useEffect)(()=>{var e;let{uniforms:a}=U;null==(e=a.uResolution)||e.value.set(r.width*t.dpr,r.height*t.dpr),n()},[r,t,n]);let{isWireframe:o}=(0,i.rr)();(0,g.useEffect)(()=>{var e,t,r,a;let{uniforms:n}=U;null==(e=n.uBgColor1)||e.value.set("#181818"),null==(t=n.uBgColor2)||t.value.set("#36393e"),null==(r=n.uBgColor1)||r.value.convertLinearToSRGB(),null==(a=n.uBgColor2)||a.value.convertLinearToSRGB()},[e.isSolidMode,o]),(0,S.C)(e=>{let{clock:t}=e,r=t.getElapsedTime();U.uniforms.uTime.value=r});let l=(0,g.useRef)(null);(0,g.useEffect)(()=>{i.rr.setState({backdropRef:l})},[]);let s=k();return(0,a.jsx)("mesh",{ref:l,visible:!s,renderOrder:0,geometry:new M.SphereGeometry(50,12,12),material:U,frustumCulled:!1})};var O=r(6534),T=r(16750);let I=(0,g.forwardRef)(function(e,t){let{isAutoRotate:r}=(0,i.rr)(),{orbitPosition:n,orbitTarget:o,mode:l}=(0,g.useContext)(y),s=(0,g.useRef)(null),u=(0,g.useCallback)((e,t)=>{let r=s.current;r&&(r.enableDamping=!1,r.update(),r.enableDamping=!0,r.position0.set(e[0],e[1],e[2]),r.target0.set(t[0],t[1],t[2]),r.reset())},[s]),c=(0,g.useCallback)(e=>{let t=s.current;if(t){let r=t.object;r instanceof M.PerspectiveCamera&&(r.fov=e,r.updateProjectionMatrix())}},[s]),d=(0,g.useCallback)(()=>{let e=s.current;return e?(e.saveState(),{orbitPosition:e.position0.toArray(),orbitTarget:e.target0.toArray(),fov:e.object instanceof M.PerspectiveCamera?e.object.fov:0}):null},[]);return(0,g.useImperativeHandle)(t,()=>({setOrbit:u,setCamera:c,getCameraInfo:d,getOrbitControl:()=>s.current})),(0,O.n)(()=>{n&&o&&u(n,o)},[n,o]),(0,a.jsx)(T.N,{ref:s,enableRotate:"rigging"!==l,enablePan:!["publish","animation-publish","rigging"].includes(l),enableZoom:"rigging"!==l,minDistance:["publish","animation-publish"].includes(l)?15:2,maxDistance:["publish","animation-publish"].includes(l)?20:25,enableDamping:!0,autoRotate:["workspace","showcase","animation","animation-preview","animation-publish"].includes(l)&&r,autoRotateSpeed:3,target:o,mouseButtons:{LEFT:M.MOUSE.ROTATE,MIDDLE:M.MOUSE.PAN,RIGHT:M.MOUSE.PAN}})});var B=r(43013),D=r(81977),P=r(44750);let L=e=>{let{HDRIKey:t}=e,{backgroundRotation:r,environmentStrength:n,isAutoRotateBackground:o,previewRenderMode:l,customHDRIUrl:s}=(0,i.rr)(),u="color"!==l,c=k(),d=null!=s?s:B.M[t].hdrUrl,p=(0,g.useRef)(0);(0,S.C)((e,t)=>{u&&o&&(p.current=(p.current+90*t)%360,i.rr.setState({backgroundRotation:Math.floor(p.current)}))});let m=[0,(0,P.pu)(r+329),0];return(0,a.jsx)(D.OH,{background:c,backgroundIntensity:n,backgroundBlurriness:.1,environmentIntensity:n,environmentRotation:m,backgroundRotation:m,files:d})},N=()=>{let{isShowGrid:e,previewRenderMode:t}=(0,i.rr)(),{mode:r}=(0,g.useContext)(y),n=["workspace","showcase","animation","animation-preview"].includes(r)&&e,o=(0,g.useRef)(null);return(0,g.useEffect)(()=>{i.rr.setState({gridWrapperRef:o})},[]),(0,a.jsx)("group",{ref:o,children:(0,a.jsx)("gridHelper",{visible:n,args:[10,10,"#585858","#3f3f3f"],position:[0,0,0]})})},W=()=>{let{previewRenderMode:e}=(0,i.rr)(),t="color"!==e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("pointLight",{intensity:12.8*!t,decay:2,position:[-3.563,3.204,-2.537]}),(0,a.jsx)("directionalLight",{intensity:4.36*!t,position:[4.665,10,7.5],rotation:[-1.252,-.501,1.832]})]})};var V=r(55182),z=r(51288),F=r(46512),G=r(56069),H=r(21375);let q=new M.MeshNormalMaterial({side:M.DoubleSide}),Y=new M.MeshBasicMaterial({color:2633003,side:M.DoubleSide,wireframe:!0});function K(e){let{isWireframe:t,previewRenderMode:r,isSolidModeWithNormalMap:n}=(0,i.rr)(),o=(0,b.p)(e.modelUrl||""),{data:l}=(0,F.Ay)(e.quadJsonUrl,e=>fetch(e).then(e=>e.json())),s=!Array.isArray(l),{linePoints:u}=(e=>{let t=!Array.isArray(e),[r,a]=(0,g.useMemo)(()=>{let r=[],a={};if(e&&t&&!e.verts||!e);else if(t){if(!e.verts||!e.faces)return[r,a];e.faces.forEach(t=>{let a=t[t.length-1],n=e.verts[a],o=t[0],l=e.verts[o];null==r||r.push(n,l);for(let a=0;a<t.length-1;a++){let n=t[a],o=t[a+1],l=e.verts[n],i=e.verts[o];null==r||r.push(l,i)}})}else e.forEach(e=>{let t=e[0],n=e[1],o=e[2],l=e[3];null==r||r.push(t,n,n,o,o,l,l,t),a[t+""]=!0});return[r,a]},[e,t]);return{linePoints:r,pointsMap:a}})(l),c=u.length>0,{mode:d}=(0,g.useContext)(y),{invalidate:p}=(0,S.A)();(0,g.useEffect)(()=>{p()},[o]),(0,g.useEffect)(()=>{(async()=>{await G.ready})()},[]);let m=(0,x.zo)("https://cdn.meshy.ai/webapp-assets/viewer/matcap/basic_MeshyFinal_Grey.jpg",e=>{e.wrapS=M.ClampToEdgeWrapping,e.wrapT=M.ClampToEdgeWrapping,e.needsUpdate=!0}),f=(0,g.useMemo)(()=>{let e=new M.MeshMatcapMaterial({color:0xa9a9a9,matcap:m,side:M.DoubleSide});return R(e),e},[m]),{viewSwitcherViewId:h}=(0,V.Y)(),v=e.forceBakedTexture?V.r.BAKED_MAP:h,w=e.isSolidMode,E=t&&["workspace","showcase"].includes(d),C="pbr"==r||["rigging"].includes(d),j="normal"===r,{scene:A,nodes:k}=o,U=(0,g.useMemo)(()=>Object.values(k).filter(e=>e instanceof M.Mesh&&e.isMesh),[k]);(0,g.useEffect)(()=>{U.forEach(e=>{if(!(e instanceof M.Mesh))return;let t=e.geometry;t.hasAttribute("normal")||t.computeVertexNormals()})},[U]),(0,g.useEffect)(()=>{n&&"solid"===r?U.forEach(e=>{if(!(e instanceof M.Mesh))return;let t=e.geometry;t.hasAttribute("position")&&t.hasAttribute("normal")&&t.hasAttribute("uv")&&!t.hasAttribute("tangent")&&(t.userData.tangent?t.setAttribute("tangent",t.userData.tangent):((0,H.WL)(t,G),t.userData.tangent=t.getAttribute("tangent")))}):"pbr"===r&&U.forEach(e=>{if(!(e instanceof M.Mesh))return;let t=e.geometry;t.hasAttribute("tangent")&&delete t.attributes.tangent})},[U,n,r]);let _=(0,g.useRef)(null);(0,g.useEffect)(()=>{let e=_.current;e.scale.setScalar(1),e.position.set(0,0,0),e.updateMatrixWorld();let t=new M.Box3().setFromObject(e),r=t.getSize(new M.Vector3),a=5/Math.max(r.x,r.y,r.z);e.scale.setScalar(a),e.position.y=-t.min.y*a},[o,A]);let O=(0,g.useMemo)(()=>j?"normal":w?n?"solid-with-normal-map":"solid":C?"pbr":"basic",[w,C,j,n]),[T,I]=(0,g.useState)(new Map);(0,g.useEffect)(()=>{U.forEach(e=>{if(!(e.material instanceof M.MeshStandardMaterial))return(0,a.jsx)(a.Fragment,{});let t=new Map(T);t.has("".concat(e.uuid,"_original"))||t.set("".concat(e.uuid,"_original"),e.material);let r="".concat(e.uuid,"_").concat(O);if(!t.has(r)){switch(O){case"normal":t.set(r,q);break;case"solid":t.set(r,f);break;case"solid-with-normal-map":var n;let a=new M.MeshMatcapMaterial({color:0xa9a9a9,matcap:m,side:M.DoubleSide,normalMap:null==(n=e.material.normalMap)?void 0:n.clone()});R(a),t.set(r,a);break;case"pbr":t.set(r,e.material);break;case"basic":let o=new M.MeshBasicMaterial({color:0xffffff,vertexColors:!e.material.map,map:e.material.map,side:M.DoubleSide});t.set(r,o)}I(t)}})},[U,O,T,f,m]);let B=(0,g.useMemo)(()=>v!==V.r.MODEL_VIEW&&e.textureUrls&&0!==Object.keys(e.textureUrls).length&&1!==e.textureUrls.reduce((e,t)=>e+Object.keys(t).length,0)&&e.enableIncomingTextureOverride?e.textureUrls.flatMap(e=>{switch(v){default:return null;case V.r.BAKED_MAP:return e.meshy5BakedColorMapUrl||e.colorMapUrl;case V.r.COLOR_MAP:return null;case V.r.ROUGHNESS_MAP:return e.roughnessMapUrl;case V.r.METALLIC_MAP:return e.metallicMapUrl;case V.r.NORMAL_MAP:return e.normalMapUrl;case V.r.HEIGHT_MAP:return e.heightMapUrl;case V.r.CURVATURE_MAP:return e.curvatureMapUrl;case V.r.AO_MAP:return e.aoMapUrl;case V.r.POSITION_MAP:return e.positionMapUrl}}).filter(e=>null!==e):[],[e.textureUrls,e.enableIncomingTextureOverride,v]),D=(0,x.zo)(B,e=>{e.forEach(e=>{e.flipY=!1,e.colorSpace=M.SRGBColorSpace,e.wrapS=M.RepeatWrapping,e.wrapT=M.RepeatWrapping,e.needsUpdate=!0})});return(0,g.useEffect)(()=>{"color"===r&&U.forEach(t=>{let r=T.get("".concat(t.uuid,"_basic"));if(!(r instanceof M.MeshBasicMaterial))return(0,a.jsx)(a.Fragment,{});let n=T.get("".concat(t.uuid,"_original"));if(!(n instanceof M.MeshStandardMaterial))return;let o=n.map;if(e.enableIncomingTextureOverride)if(D.length>0)o=D[0];else switch(v){default:case V.r.BAKED_MAP:case V.r.COLOR_MAP:o=n.map;break;case V.r.ROUGHNESS_MAP:o=n.roughnessMap;break;case V.r.METALLIC_MAP:o=n.metalnessMap;break;case V.r.NORMAL_MAP:o=n.normalMap}r.map=o,r.needsUpdate=!0})},[T,r,D,U,v,e.enableIncomingTextureOverride]),(0,a.jsx)("group",{ref:_,children:U.map(e=>{var t;e.updateMatrixWorld(),e.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.rotation.setFromQuaternion(e.quaternion);let r="".concat(e.uuid,"_").concat(O),n=null!=(t=T.get(r))?t:f;return(0,a.jsxs)("group",{scale:e.scale,position:e.position,rotation:e.rotation,children:[(0,a.jsx)("mesh",{geometry:e.geometry,material:n,renderOrder:1}),E&&c&&(0,a.jsx)("group",{rotation:s?[0,0,0]:[Math.PI/2,Math.PI,Math.PI],children:(0,a.jsx)(z.N,{points:u||[],color:2633003,lineWidth:1,segments:!0,dashed:!1,renderOrder:2})}),E&&!c&&(0,a.jsx)("mesh",{material:Y,renderOrder:2,geometry:e.geometry})]},e.uuid)})})}var $=r(48374);let J=new M.Matrix4,Q=new M.Matrix4,X=new M.Matrix4,Z=new M.Matrix4().makeTranslation(0,2.5,0),ee=new M.Matrix4().makeTranslation(0,-2.5,0),et=new M.Object3D,er=e=>{let{mode:t}=(0,g.useContext)(y),{riggingOffset:r,riggingRotation:n,riggingType:o}=(0,i.rr)(),{invalidate:l}=(0,S.A)(),s=(0,g.useRef)(null),u=(0,g.useRef)(null);return(0,g.useEffect)(()=>{if("rigging"!==t)return;let e=s.current;e.matrixWorld.identity(),e.position.set(0,0,0),e.scale.set(1,1,1),e.rotation.set(0,0,0),o===$.a$.Quadruped&&(et.position.set(0,.6,0),et.rotation.y=M.MathUtils.degToRad(-90),et.scale.set(.88,.88,.88),et.updateMatrixWorld(),e.matrixWorld.copy(et.matrixWorld));let a=(null!=n?n:[0,0,0]).map(e=>M.MathUtils.degToRad(e));J.identity().makeRotationX(a[0]),Q.identity().makeRotationY(a[1]),X.identity().makeRotationZ(a[2]),e.matrixWorld.multiply(Z).multiply(J).multiply(Q).multiply(X).multiply(ee),e.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.rotation.setFromQuaternion(e.quaternion),u.current.position.set(...null!=r?r:[0,0,0]),u.current.updateMatrixWorld(),l()},[l,t,r,n,o]),(0,a.jsx)(a.Fragment,{children:"rigging"===t?(0,a.jsx)("group",{ref:u,children:(0,a.jsx)("group",{ref:s,children:e.children})}):(0,a.jsx)(a.Fragment,{children:e.children})})},ea=(0,g.forwardRef)(function(e,t){let{gl:r,scene:n,camera:o}=(0,S.A)(),{gridWrapperRef:l,backdropRef:s}=(0,i.rr)(),u=(0,g.useCallback)(()=>{(null==l?void 0:l.current)&&(l.current.visible=!1),(null==s?void 0:s.current)&&(s.current.visible=!1),r.clear(),r.render(n,o);let e=r.domElement.toDataURL();return(null==l?void 0:l.current)&&(l.current.visible=!0),(null==s?void 0:s.current)&&(s.current.visible=!0),e},[s,o,r,l,n]),c=(0,g.useCallback)(async()=>((null==l?void 0:l.current)&&(l.current.visible=!1),(null==s?void 0:s.current)&&(s.current.visible=!1),i.rr.setState({renderingSolidSnapshot:!0}),new Promise(e=>{setTimeout(()=>{r.clear(),r.render(n,o);let t=r.domElement.toDataURL();(null==l?void 0:l.current)&&(l.current.visible=!0),(null==s?void 0:s.current)&&(s.current.visible=!0),i.rr.setState({renderingSolidSnapshot:!1}),e(t)},200)})),[s,o,r,l,n]);return(0,g.useImperativeHandle)(t,()=>({getSnapshot:u,getSolidSnapshot:c}),[u,c]),(0,a.jsx)(a.Fragment,{})});var en=r(49779);let eo={fov:15.72,position:[0,2.5,20],target:[0,2.5,0]},el=e=>{let{modelUrl:t,quadJsonUrl:r,textureUrls:n,HDRIKey:o="default",forceSolidMode:l,forceBakedTexture:c,enableIncomingTextureOverride:d=!1,mode:m="showcase",xForward:f=!1,orbitPosition:h=f?en.u_:en.du,orbitTarget:v=[en.Dq[0],en.Dq[1],en.Dq[2]],onReadyChange:x,skeletonModelUrl:b,animationModelUrl:w,ref:S}=e,R=["animation","animation-preview","animation-publish"].includes(m),E=["publish","animation-publish"].includes(m),[C,j]=(0,g.useState)(!1);(0,s.O)([["mod + shift + alt + n",()=>{i.rr.setState({previewRenderMode:"normal"})}]]);let k=(e=>{let{isRigging:t,previewRenderMode:r}=(0,i.rr)(),[a,n]=(0,g.useState)("demand");return(0,g.useEffect)(()=>{t&&!["rigging","animation","animation-preview","animation-publish"].includes(e)?n("never"):n("demand")},[t,e,r]),a})(m);(0,g.useEffect)(()=>{j(!0),setTimeout(()=>{j(!1)},50)},[t]),(0,g.useEffect)(()=>(x(!0),()=>{x(!1)}),[x]);let U=(0,g.useRef)(null),O=(0,g.useRef)(null);(0,g.useImperativeHandle)(S,()=>({getSnapshot(){var e,t;return(null==(t=U.current)||null==(e=t.getSnapshot)?void 0:e.call(t))||""},getSolidSnapshot(){var e,t;return(null==(t=U.current)||null==(e=t.getSolidSnapshot)?void 0:e.call(t))||new Promise((e,t)=>{e("")})},getCameraInfo:()=>{var e,t;return(null==(t=O.current)||null==(e=t.getCameraInfo)?void 0:e.call(t))||null},setOrbit(e,t){var r;return null==(r=O.current)?void 0:r.setOrbit(e,t)},setCamera(e){var t;return null==(t=O.current)?void 0:t.setCamera(e)},getOrbitControl:()=>{var e,t;return(null==(t=O.current)||null==(e=t.getOrbitControl)?void 0:e.call(t))||null}}),[]);let{previewRenderMode:T,renderingSolidSnapshot:B}=(0,i.rr)(),D=B||l||"solid"==T&&["workspace","showcase"].includes(m);return(0,a.jsx)("div",{className:(0,p.A)("relative flex size-full items-center justify-center transition-opacity duration-150",{"opacity-0":C}),children:(0,a.jsx)(y.Provider,{value:{mode:m,orbitPosition:h,orbitTarget:v},children:(0,a.jsxs)(u.Hl,{gl:{antialias:!0,toneMapping:M.NeutralToneMapping,toneMappingExposure:2},camera:{fov:"rigging"===m?eo.fov:en.io,position:h,far:100},frameloop:k,shadows:!0,resize:{offsetSize:!0},dpr:E?3:[1,2],children:[!R&&t&&(0,a.jsx)(er,{children:(0,a.jsx)(K,{modelUrl:t,quadJsonUrl:r,textureUrls:n,isSolidMode:D,forceBakedTexture:c,enableIncomingTextureOverride:d})}),R&&(0,a.jsx)(A,{skeletonModelUrl:b,animationModelUrl:w}),(0,a.jsx)(N,{}),(0,a.jsx)(W,{}),(0,a.jsx)(_,{isSolidMode:D}),(0,a.jsx)(L,{HDRIKey:o}),(0,a.jsx)(I,{ref:O}),(0,a.jsx)(ea,{ref:U})]})})})},ei=e=>{let{onReadyChange:t}=e;return(0,g.useEffect)(()=>(t(!1),()=>{t(!0)}),[t]),(0,a.jsx)("div",{className:"flex size-full flex-col items-center justify-center gap-4",children:(0,a.jsx)(o.A,{type:"dots"})})},es=e=>{var t,r,o,i;let{error:s,resetErrorBoundary:u,modelURL:d}=e,p=(0,f.c3)(),{myInfo:h}=(0,c.Iy)(),[v,M]=(0,g.useState)(!1),x=(null==(t=d.match(/\?.*$/))?void 0:t[0])||"",b=s.message||"",w=null==(r=s.stack)?void 0:r.replaceAll(b,""),S="Location: ".concat(location.href,"\n\n").concat(b.replaceAll(x,""),"\n\nStack: ").concat(null==w?void 0:w.replaceAll(x,"")),y=location.href,R=null==(i=s.message.match(/https:\/\/[\w-]+\.meshy\.ai\/[^\s]+?:/))||null==(o=i[0])?void 0:o.replace(/:$/,""),E=async()=>{M(!0),l.toast.success(p("Toast.Message.Success.ReportModelError"));let e="Model Error Report",t="*Title:* `".concat(e,"`\n")+"*User ID:* `".concat(null==h?void 0:h.userId,"`\n")+"*Email:* `".concat(null==h?void 0:h.email,"`\n")+"*Location:* `".concat(y,"`\n")+"*Error Description:* `Model Viewer Error`\n"+"*Error Message:* `".concat(b.replaceAll(d,"<".concat(d,"|*ErrorModelUrl*>")),"`"),r={method:"POST",body:JSON.stringify({title:e,mainContent:t,threadTitle:"*Stack: *\n",threadMessage:w})};await fetch("/api/issue-report",r)},C=(0,m.A)(E,3e3);return"Error creating WebGL context."===s.message?(0,a.jsx)("div",{className:"max-w-[50%] space-y-2 text-center text-sm",children:(0,a.jsx)("div",{children:p("Component.Viewer.Error.ErrorCreatingWebGLContext")})}):(0,a.jsxs)("div",{className:"flex size-full flex-col items-center justify-center gap-2 text-center text-sm",children:[(0,a.jsx)("div",{children:p("Component.Viewer.Error.Default")}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(n.default,{onClick:()=>{R&&fetch(R,{method:"GET",cache:"no-cache"}),window.location.reload()},size:"sm",type:"secondary",children:p("Component.Viewer.Error.Retry")}),(0,a.jsx)(n.default,{onClick:()=>{navigator.clipboard.writeText(S),l.toast.success(p("Toast.Message.Success.CopyToClipboard"))},size:"sm",type:"secondary",children:p("Component.Viewer.Error.CopyErrorDetail")}),(0,a.jsx)(n.default,{disabled:v,onClick:C,type:"secondary",size:"sm",children:p("App.ClientError.ReportButton")})]})]})},eu=e=>{let t=(0,f.c3)(),[r,n]=(0,g.useState)(!1),o=(0,g.useRef)(null),l=e.ref;return((0,g.useImperativeHandle)(l,()=>({ready:r,getSnapshot:()=>{var e,t;return(null==(t=o.current)||null==(e=t.getSnapshot)?void 0:e.call(t))||""},getSolidSnapshot:()=>{var e,t;return(null==(t=o.current)||null==(e=t.getSolidSnapshot)?void 0:e.call(t))||new Promise((e,t)=>{e("")})},getCameraInfo:()=>{var e,t;return(null==(t=o.current)||null==(e=t.getCameraInfo)?void 0:e.call(t))||null},setOrbit:(e,t)=>{var r,a;null==(a=o.current)||null==(r=a.setOrbit)||r.call(a,e,t)},setCamera:e=>{var t,r;null==(r=o.current)||null==(t=r.setCamera)||t.call(r,e)},getOrbitControl:()=>{var e,t;return(null==(t=o.current)||null==(e=t.getOrbitControl)?void 0:e.call(t))||null}}),[r]),e.modelUrl||e.animationModelUrl||e.skeletonModelUrl)?(0,a.jsx)(g.Suspense,{fallback:(0,a.jsx)(ei,{onReadyChange:n}),children:(0,a.jsxs)(v.ErrorBoundary,{resetKeys:[e.modelUrl],FallbackComponent:t=>{let{error:r,resetErrorBoundary:n}=t;return(0,a.jsx)(es,{modelURL:e.modelUrl||"",error:r,resetErrorBoundary:n})},onError:e=>{d.Cp(e)},children:[(0,a.jsx)(el,{...e,onReadyChange:n,ref:o}),e.children]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-label-muted z-10 text-xs font-normal select-none",children:t("Component.Viewer.Placeholder")}),(0,a.jsx)("div",{className:"absolute bottom-20 h-[330px] w-[1270px] select-none",children:(0,a.jsx)(h.default,{className:"pointer-events-none size-full",src:"https://cdn.meshy.ai/webapp-assets/viewer/placeholder-for-viewer.svg",width:1270,height:330,alt:"placeholder-for-viewer",unoptimized:!0})})]})}}}]);