try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="835ded57-b68c-492f-a0c6-cea00082aaff",e._sentryDebugIdIdentifier="sentry-dbid-835ded57-b68c-492f-a0c6-cea00082aaff")}()}catch(e){}!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[(new e.Error).stack]=function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];if(null!=a)for(var t in a)a.hasOwnProperty(t)&&(e[t]=a[t])}return e}({},e._sentryModuleMetadata[(new e.Error).stack],{"_sentryBundlerPluginAppKey:bWVzaHktd2ViYXBwLSMx":!0})}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4769],{37545:(e,s,a)=>{a.d(s,{r:()=>v});var t=a(95155),l=a(52513),i=a(74765),r=a(20701),o=a(42047),n=a(880),c=a(52787),d=a(22317),u=a(38143),m=a(18424),h=a(59962),x=a(18955),b=a(12115);let f=async(e,s,a,t)=>{if(!s&&!t)return;let i=await (0,l.getAccessToken)();await (0,m.Jg)({result:{reason:e,showcaseId:null!=s?s:"",collectionId:null!=a?a:"",userId:null!=t?t:""},key:"meshy:report:showcase"},i)},v=e=>{let{showcaseId:s,collectionId:a,trigger:l,userId:m,className:v}=e,p=(0,x.c3)(),[g,j]=(0,b.useState)(!1),[y,k]=(0,b.useState)(""),w=(0,u.j)(e=>e.showcaseDialogRef),N=(0,d.n)(e=>e.isAuthenticated),S=async()=>{try{var e;await f(y,s,a,m),n.toast.success(p("Dashboard.Discover.CommunityShowcase.Report.Success")),j(!1),k(""),null==(e=w.current)||e.close(!0)}catch(e){n.toast.error(p("Dashboard.Discover.CommunityShowcase.Report.Error"))}};return N?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.Ay,{open:g,onOpenChange:j,title:p("Dashboard.Discover.CommunityShowcase.Report.Title"),onSubmit:S,submitText:p("Dashboard.Discover.CommunityShowcase.Report.Submit"),trigger:l||(0,t.jsx)(c.A,{title:p("Dashboard.Discover.CommunityShowcase.Report.Tooltip"),asChild:!0,children:(0,t.jsx)("div",{className:v,children:(0,t.jsx)(i.default,{type:"icon-tertiary",size:"sm",icon:(0,t.jsx)(h.A,{className:"size-4"})})})}),children:(0,t.jsx)(o.A,{value:y,onChange:e=>k(e.target.value),placeholder:p("Dashboard.Discover.CommunityShowcase.Report.Placeholder"),required:!0,disabled:!1,maxLength:500,rows:5})})}):null}},64769:(e,s,a)=>{a.d(s,{Y:()=>eY,n:()=>eX});var t,l,i=a(95155),r=a(47380),o=a(33445),n=a(52210),c=a(37545),d=a(95333),u=a(74765),m=a(52513),h=a(20701);a(70957);var x=a(52787),b=a(43838),f=a(8952),v=a(99255);a(86573);var p=a(7267),g=a(92565);a(39258);var j=a(16680),y=a(23369),k=a(47499),w=a(45966),N=a(78524),S=a(18955),A=a(12115),T=a(216);function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e}).apply(this,arguments)}let P=function(e){return A.createElement("svg",C({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),t||(t=A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.33 5.33C4.22 6.442 3.75 8.395 3.75 12s.469 5.558 1.58 6.67c1.112 1.111 3.065 1.58 6.67 1.58s5.558-.469 6.67-1.58c1.111-1.112 1.58-3.065 1.58-6.67s-.469-5.558-1.58-6.67C17.558 4.22 15.605 3.75 12 3.75s-5.558.469-6.67 1.58ZM4.27 4.27C5.858 2.68 8.405 2.25 12 2.25c3.595 0 6.142.431 7.73 2.02 1.589 1.588 2.02 4.135 2.02 7.73 0 3.595-.431 6.142-2.02 7.73-1.588 1.589-4.135 2.02-7.73 2.02-3.595 0-6.142-.431-7.73-2.02C2.68 18.142 2.25 15.595 2.25 12c0-3.595.431-6.142 2.02-7.73Z",fill:"currentColor"})),l||(l=A.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.712 8.237a.75.75 0 0 0-.95-.948l-6 2a.75.75 0 0 0-.473.474l-2 6a.75.75 0 0 0 .948.949l6-2a.75.75 0 0 0 .474-.475l2-6Zm-6.12 2.356-1.406 4.221 4.221-1.407 1.407-4.221-4.221 1.407Z",fill:"currentColor"})))};var I=a(19742),z=a(98654),D=a(61691),_=a(66292),W=a(67781),M=a(880),U=a(15547),E=a(90589),F=a(18359),R=a(49779),O=a(98803),Z=a(92956),L=a(11397),V=a(15692),J=a(9285),B=a(48374),H=a(5573),q=a(1888),K=a(6534),G=a(14669),X=a(27318),Y=a(48239),Q=a(69095),$=a(20840),ee=a(27323),es=a(60829),ea=a(42047),et=a(54622),el=a(53034),ei=a(7106),er=a(73768),eo=a(41871),en=a(12209),ec=a(36834),ed=a(60252),eu=a(92214),em=a(65335),eh=a(45361),ex=a(44995),eb=a(99729),ef=a(83157),ev=a(23796),ep=a(98278),eg=a(94748),ej=a(70626),ey=a(52619),ek=a.n(ey);let ew=[{key:"Showcase.Tag.Animals",value:"animals-pets",icon:ei.A},{key:"Showcase.Tag.Architecture",value:"architecture",icon:er.A},{key:"Showcase.Tag.ArtAbstract",value:"art-abstract",icon:eo.A},{key:"Showcase.Tag.Characters",value:"characters-creatures",icon:en.A},{key:"Showcase.Tag.CultureHistory",value:"cultural-heritage-history",icon:ec.A},{key:"Showcase.Tag.Electronics",value:"electronics-gadgets",icon:ed.A},{key:"Showcase.Tag.FashionStyle",value:"fashion-style",icon:eu.A},{key:"Showcase.Tag.FoodDrink",value:"food-drink",icon:em.A},{key:"Showcase.Tag.FurnitureHome",value:"furniture-home",icon:eh.A},{key:"Showcase.Tag.Music",value:"music",icon:ex.A},{key:"Showcase.Tag.NaturePlants",value:"nature-plants",icon:eb.A},{key:"Showcase.Tag.PlacesTravel",value:"places-travel",icon:ef.A},{key:"Showcase.Tag.ScienceTechnology",value:"science-technology",icon:ev.A},{key:"Showcase.Tag.SportsFitness",value:"sports-fitness",icon:ep.A},{key:"Showcase.Tag.Vehicles",value:"cars-vehicles",icon:eg.A},{key:"Showcase.Tag.WeaponsMilitary",value:"weapons-military",icon:ej.A}],eN=e=>{let{value:s,active:a,disabled:t}=e,l=(0,S.c3)(),r=ew.find(e=>e.value===s);if(!r)return null;let o=r.icon,n=l(r.key);return(0,i.jsxs)("div",{className:(0,Q.A)("inline-flex h-7 cursor-pointer items-center justify-center gap-1 rounded-[10px] px-2 text-xs font-medium",{"border-bg-border bg-bg-base-hover text-label-base hover:bg-bg-shade":!a&&!t,"border-accent-base bg-accent-base text-accent-label":a&&!t,"cursor-not-allowed opacity-50":t}),children:[o&&(0,i.jsx)(o,{stroke:1.5,className:"flex size-4 items-center justify-center"}),(0,i.jsx)("div",{className:"select-none",children:n})]})},eS=e=>{let{taskId:s,sketchfabModelUid:a,modelUrl:t,name:l,objectPrompt:r,allPromote:o,artStyle:n,isUploading:c,setIsUploading:h}=e,x=(0,S.c3)(),b="".concat(window.location.origin,"/oauth/sketchfab"),f="https://sketchfab.com/oauth2/authorize/?response_type=token&client_id=".concat(el.ID,"&redirect_uri=").concat(b),v=(0,d.n)(),[p,g]=(0,A.useState)({success:!1}),[j,k]=(0,A.useState)(["meshy","createdwithai","ai",...n?[n]:[]]),[w,N]=(0,A.useState)([]),[C,P]=(0,A.useState)(l||r||""),z=(0,U.S)({id:s,objectPrompt:r||l}),D="This model was generated using Meshy(https://www.meshy.ai)'s AI toolkit. It provides tools that effortlessly turn human imagination into stunning 3D models.\n\nIf you're interested in this model, visit the model page on Meshy to explore more about it: [".concat(z,"?utm_source=sketchfab](").concat(z,"?utm_source=sketchfab)"),[_,W]=(0,A.useState)(D),E=(0,A.useCallback)(async e=>{if(!t||C.length>48)return;h(!0);let l=await fetch(t),i=await l.blob(),r={modelFile:i,name:C.slice(0,48),description:_.slice(0,1024),tags:j.join(" ").toLowerCase(),categories:w.join(",")},o=await (0,y.g)(r,e);if(o){g({success:!0,url:o.uri,uid:o.uid});let e=await (0,m.getAccessToken)();await (0,y.mQ)(s,{sketchfabModelUid:a||o.uid},e),M.toast.success(x("SketchfabShare.UploadSuccessful"))}else console.error("Upload failed"),g({success:!1}),M.toast.error(x("SketchfabShare.UploadFailed"));h(!1)},[t,C,h,_,j,w,s,a,x]);(0,A.useEffect)(()=>{let e=e=>{e.data.accessToken&&e.data.expiresIn&&E(e.data.accessToken)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[E]);let R="".concat(el.pB).concat(p.uid||a),L=a||p.uid;return(0,i.jsxs)(i.Fragment,{children:[L?(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex h-full flex-col items-center justify-start gap-4 py-3",children:[(0,i.jsxs)("div",{className:"bg-bg-strong text-label-muted [&_i]:text-label-base flex w-full flex-col items-center justify-center rounded-xl p-3 text-xs font-medium [&_i]:not-italic",children:[(0,i.jsx)("div",{className:"mt-0.5 flex size-8 items-center justify-center",children:(0,i.jsx)(X.A,{className:"size-8 text-green-500",stroke:2})}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("div",{className:"text-label-muted mt-2",children:x("SketchfabShare.Hint.UploadSuccessful")})})]}),(0,i.jsx)(O.C,{modelPreviewUrl:R,className:"text-label-muted text-xs font-normal",tracking:"3d_models"}),(0,i.jsx)(Z.T,{modelPreviewUrl:R,className:"text-label-muted text-xs font-normal",isSketchfab:!0,tracking:"3d_models"})]})}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"space-y-4 overflow-auto py-3",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-label-muted flex h-7 items-center text-xs font-normal",children:x("Workspace.Publish.Title")}),(0,i.jsx)(et.A,{value:C,status:C.length>48?"error":"default",onChange:e=>P(e.target.value),disabled:c}),C.length>48&&(0,i.jsx)("div",{className:"text-semantic-error-highlight text-sm leading-5 font-normal",children:x("Workspace.Publish.ErrorMsg.TitleTooLong")})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"text-label-muted flex h-7 items-center text-xs font-normal",children:x("Workspace.Publish.Description")}),(0,i.jsx)(ea.A,{value:_,onChange:e=>W(e.target.value),rows:5,disabled:c})]}),(0,i.jsx)(F.u,{selectedTags:j,setSelectedTags:k,disabled:c,prompt:o,validateTag:e=>V.r.test(e)||""===e.trim()?"":x("Workspace.Publish.Tags.ValidSketchfabError")}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"text-label-muted flex h-7 items-center text-xs font-normal",children:[x("Workspace.Publish.Categories.Default")," (1-2)"]}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:ew.map(e=>{let s=w.includes(e.value),a=s||w.length<2;return(0,i.jsx)("div",{onClick:a?()=>{s?N(w.filter(s=>s!==e.value)):a&&N([...w,e.value])}:void 0,children:(0,i.jsx)(eN,{value:e.value,active:s,disabled:c})},e.value)})})]})]})}),(0,i.jsx)("div",{className:"border-bg-border border-t pt-3",children:L?(0,i.jsx)(ek(),{href:R,children:(0,i.jsx)(u.default,{type:"primary",block:!0,children:x("SketchfabShare.ViewModelOnSketchfab")})}):(0,i.jsxs)(u.default,{type:"primary",block:!0,onClick:()=>{if(C.length>48)return;let e=(window.screen.width-500)/2,s=(window.screen.height-500)/2;v("model_publish_to_sketchfab"),window.open(f,"SketchfabAuth","width=".concat(500,",height=").concat(500,",left=").concat(e,",top=").concat(s)),localStorage.setItem("sketchfabAuth",JSON.stringify({accessToken:"",expiresIn:""}))},disabled:c,className:"bg-[hsl(197,60%,57%)] text-white hover:bg-[hsl(197,60%,63%)] active:bg-[hsl(197,60%,51%)]",children:[c&&(0,i.jsx)(I.A,{className:"size-5 animate-spin"}),!c&&(0,i.jsx)(T.A,{className:"size-6"}),x("SketchfabShare.ShareToSketchfab")]})})]})};var eA=a(19181);let eT=e=>{var s;let{onPublished:a,onUnpublished:t,currentTaskId:l,isAnimation:r,isSubmitting:o,setIsSubmitting:n}=e,c=(0,S.c3)(),{myInfo:d}=(0,f.Iy)(),{check:h,component:x}=(0,E.o)(),[b,v]=(0,A.useState)("meshy"),[k,N]=(0,A.useState)([]),[C,ea]=(0,A.useState)([]),[et,el]=(0,A.useState)(!1),{data:ei,mutate:er}=(0,p.ZE)(r?null:l),{data:eo,mutate:en}=(0,D.Pt)(r?l:null),ec=r?null==eo?void 0:eo.taskJson:ei,ed=r?null==eo?void 0:eo.isPublished:null==ei?void 0:ei.isPublished,eu=(null==ec?void 0:ec.mode)===j.nN.ImageTo3D,em=(null==ec?void 0:ec.aiModel)===j.jZ.Meshy4,eh=eu&&!em,ex=null==ec?void 0:ec.objectPrompt,eb=null==ec?void 0:ec.stylePrompt,ef=null==ec?void 0:ec.name,ev=r?null==eo?void 0:eo.taskJson.modelUrl:null==ei||null==(s=ei.result)?void 0:s.modelUrl,ep=[ef,ex,eb].filter(e=>!!e).join(", "),{data:eg}=(0,$.A)(ep,async()=>(0,H.dY)(ep)),ej=null==eg?void 0:eg.categories,ey=null==ei?void 0:ei.isNSFW;(0,K.n)(()=>{if(ej){let e=[...k,...ej];N(e.length>3?e.slice(0,3):e)}},[ej]),(0,A.useEffect)(()=>{ey&&el(!0)},[ey]);let ek=async()=>{var e,s,t,i,o;let u;if(!h())return;if(0===k.length)return void M.toast.error(c("Workspace.Publish.Tags.Error"));{let e=await (null==(o=g.W.getState().publishViewerRef)||null==(i=o.current)?void 0:i.getSolidSnapshot());if(!e)return void M.toast.error(c("Workspace.Publish.Toast.Error"));let s=await (0,es.IK)(e);if(!s)return void M.toast.error(c("Workspace.Publish.Toast.Error"));n(!0);let{file:a,folder:t}=s,l=await (0,m.getAccessToken)(),r=await (0,q.E0)(a,["publish",t],l);if(!r){M.toast.error(c("Settings.Profile.Avatar.Editor.Toast.UploadFailure")),n(!1);return}u=r}let x=null==(s=g.W.getState().publishViewerRef)||null==(e=s.current)?void 0:e.getSnapshot();if(!x)return void M.toast.error(c("Workspace.Publish.Toast.Error"));let b=await (0,es.IK)(x);if(!b)return void M.toast.error(c("Workspace.Publish.Toast.Error"));n(!0);let{file:f,folder:v}=b,p=await (0,m.getAccessToken)(),w=await (0,q.E0)(f,["publish",v],p);if(!w){M.toast.error(c("Settings.Profile.Avatar.Editor.Toast.UploadFailure")),n(!1);return}let{previewRenderMode:N}=J.rr.getState(),{orbitPosition:S,orbitTarget:A}=(null==(t=g.W.getState().publishViewerRef.current)?void 0:t.getCameraInfo())||{orbitPosition:R.du,orbitTarget:R.Dq},T=r?B.A8:y.CS,P=await T(l,{thumbnailUrl:w,solidThumbnailUrl:u,author:(null==d?void 0:d.nickname)||"",authorAvatarURL:(null==d?void 0:d.avatarUrl)||"",categories:k,license:j.JW.CC_ZERO,isNSFW:et,previewSettingsJson:{previewRenderMode:N,orbitPosition:S,orbitTarget:A},tags:C});if(n(!1),!P)return void M.toast.error(c("Workspace.Publish.Toast.Error"));er(),en(),M.toast.success(c("Workspace.Publish.Toast.Success")),a(P)},ew=async()=>{n(!0);let e=r?B.jJ:y.z7,s=await e(l);if(!s)return void M.toast.error(c("Workspace.Unpublish.Toast.Error"));await er(),await en(),M.toast.success(c("Workspace.Unpublish.Toast.Success")),n(!1),t(s)},eN=[{value:"meshy",text:"Meshy Community",icon:(0,i.jsx)(P,{className:"size-5"})},...r?[]:[{value:"sketchfab",text:"Sketchfab",icon:(0,i.jsx)(T.A,{className:"size-5"})}]];return(0,i.jsxs)("div",{className:(0,Q.A)("relative flex h-full min-h-0 gap-6",{"p-2":ed}),children:[(0,i.jsx)("div",{className:"w-1/2 space-y-4",children:(0,i.jsx)("div",{className:"aspect-square size-full flex-none",children:r?(0,i.jsx)(es.Xm,{taskId:l}):(0,i.jsx)(es.Og,{taskId:l})})}),(0,i.jsxs)("div",{className:"z-0 flex w-1/2 flex-col justify-between",children:[!r&&(0,i.jsx)("div",{className:"border-bg-border border-b pb-3",children:(0,i.jsx)(_.A,{options:eN,value:b,onChange:v,disabled:o})}),"meshy"===b&&(0,i.jsxs)(i.Fragment,{children:[ed?(0,i.jsxs)("div",{className:"flex h-full flex-col items-center justify-start gap-4 py-3",children:[(0,i.jsxs)("div",{className:"bg-bg-strong text-label-muted [&_i]:text-label-base flex w-full flex-col items-center justify-center rounded-xl p-3 text-xs font-medium [&_i]:not-italic",children:[(0,i.jsx)("div",{className:"mt-0.5 flex size-8 items-center justify-center",children:(0,i.jsx)(X.A,{className:"size-8 text-green-500",stroke:2})}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("div",{className:"text-label-muted mt-2",children:c("Workspace.Publish.SuccessMessage")})})]}),(0,i.jsx)(O.C,{modelPreviewUrl:(0,U.S)({id:l,objectPrompt:(null==ec?void 0:ec.objectPrompt)||(null==ec?void 0:ec.name),isAnimation:r}),tracking:"3d_models",className:"text-label-muted text-xs font-normal"}),(0,i.jsx)(Z.T,{modelPreviewUrl:(0,U.S)({id:l,objectPrompt:(null==ec?void 0:ec.objectPrompt)||(null==ec?void 0:ec.name),isAnimation:r}),className:"text-label-muted text-xs font-normal",tracking:"3d_models"})]}):(0,i.jsxs)("div",{className:"space-y-4 overflow-auto py-3",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("div",{className:"bg-bg-strong text-label-muted [&_i]:text-label-base mb-4 rounded-xl p-3 text-xs font-medium [&_i]:not-italic",children:[(0,i.jsx)("div",{className:"mb-2",children:c("Settings.Balance.GetCredits.FeaturedShowcase.Description",{credits:L._})}),(0,i.jsxs)("div",{className:"text-semantic-info-highlight",children:[(0,i.jsx)(G.A,{className:"mr-1 inline-block size-4 align-sub"}),c("Workspace.Publish.Tips.BeforePublishing")]})]}),(0,i.jsx)(F.u,{selectedTags:C,setSelectedTags:ea,validateTag:e=>V.l.test(e)||""===e.trim()?"":c("Workspace.Publish.Tags.ValidError"),prompt:ep,disabled:o}),(0,i.jsxs)("div",{className:"text-label-muted flex h-7 items-center text-xs font-normal",children:[c("Workspace.Publish.Categories.Default")," (1-3)"]}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:eA.rh.map(e=>{let s=k.includes(e.value),a=k.length<3||s;return(0,i.jsx)("div",{onClick:a?()=>{!o&&(s?N(k.filter(s=>s!==e.value)):a&&N([...k,e.value]))}:void 0,children:(0,i.jsx)(eA.qO,{value:e.value,active:s,disabled:o})},e.value)})})]}),(0,i.jsxs)("div",{className:"text-label-muted space-y-1 text-xs font-normal",children:[(0,i.jsx)("div",{className:"flex h-7 items-center",children:c("Workspace.Publish.License.Default")}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(z.A,{}),(0,i.jsx)("div",{className:"text-sm font-medium text-white",children:"CC0"})]}),(0,i.jsx)("div",{children:c("Workspace.Publish.License.Description")})]}),(0,i.jsx)("div",{className:"bg-bg-border h-px"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(W.A,{checked:et,onChange:el,disabled:ey||o}),(0,i.jsx)("div",{className:"text-sm font-medium text-white",children:c("Workspace.Publish.NSFW")})]})]}),(0,i.jsxs)("div",{className:"border-bg-border border-t pt-3",children:[ed?(0,i.jsxs)(u.default,{type:"secondary",block:!0,onClick:ew,disabled:o,className:"mt-4",children:[o&&(0,i.jsx)(I.A,{className:"size-5 animate-spin"}),!o&&(0,i.jsx)(Y.A,{stroke:1.5,className:"size-6"}),c("Workspace.Unpublish.Action")]}):(0,i.jsxs)(u.default,{type:"primary",block:!0,onClick:ek,disabled:o||eh,children:[o&&(0,i.jsx)(I.A,{className:"size-5 animate-spin"}),!o&&(0,i.jsx)(w.A,{stroke:1.5,className:"size-6"}),c("Workspace.Publish.Action")]}),(0,i.jsx)("div",{className:"text-label-muted mt-2 text-center text-xs font-normal",children:(0,i.jsx)(ee.M,{})})]})]}),"sketchfab"===b&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(eS,{taskId:l,sketchfabModelUid:r?null==eo?void 0:eo.sketchfabModelUid:null==ei?void 0:ei.sketchfabModelUid,modelUrl:ev,name:(null==ec?void 0:ec.name)||(null==ec?void 0:ec.objectPrompt),objectPrompt:(null==ec?void 0:ec.name)||(null==ec?void 0:ec.objectPrompt),allPromote:ep,artStyle:null==ec?void 0:ec.artStyle,isUploading:o,setIsUploading:n})})]}),eh&&(0,i.jsx)("div",{className:"absolute inset-0 z-1 flex w-full items-center justify-center rounded-xl bg-black/10 backdrop-blur-md",children:(0,i.jsx)("div",{className:"flex flex-col items-center justify-center gap-2 text-base",children:c("Workspace.Publish.Unavailable")})}),x]})};a(42073),a(47474);var eC=a(82903);function eP(e){let{id:s,children:a,showcaseId:t,onSuccess:l,disabled:r}=e,o=(0,S.c3)(),[n,c]=(0,A.useState)(!1),d=async()=>{if(r)return;if(!s||t){null==l||l();return}let e=await (0,m.getAccessToken)();await (0,y.mQ)(s,{isPublic:!0},e)?null==l||l():setTimeout(()=>{c(!0)},1e3)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{onClick:d,className:"w-full",children:a}),(0,i.jsx)(h.Ay,{title:o("Workspace.Shared.WorkspaceToolbar.Share.SetPublicFail.Title"),description:o("Workspace.Shared.WorkspaceToolbar.Share.SetPublicFail.Description"),open:n,onOpenChange:c,onSubmit:()=>d(),submitText:o("Workspace.Shared.WorkspaceToolbar.Share.SetPublicFail.Action")})]})}var eI=function(e){return e.Publish="publish",e.Share="share",e}(eI||{});let ez=e=>{let{taskId:s,taskStatus:a,taskMode:t,defaultTab:l="publish",showcaseId:r,hiddenTabs:o=[],mutate:n,isAnimation:c=!1,children:d}=e,u=(0,S.c3)(),[m,x]=(0,A.useState)(l),[g,y]=(0,A.useState)(!1),[T,C]=(0,A.useState)(!1),[P,I]=(0,A.useState)(!1),{data:z}=(0,v.JA)(),[D,_]=(0,A.useState)(""),{myInfo:W}=(0,f.Iy)(),{data:M}=(0,p.G2)(s),U=(null==W?void 0:W.userId)===(null==M?void 0:M.userId),E=t===j.nN.ImageToTexture||t===j.nN.TextTo3DV2Coarse||a!==j.FX.Succeeded;(0,A.useEffect)(()=>{(null==z?void 0:z.isForbiddenPublish)&&x("share")},[null==z?void 0:z.isForbiddenPublish]);let F=e=>{(null==e?void 0:e.meshyChristmasAdventurePromotionCode)&&(_(e.meshyChristmasAdventurePromotionCode),C(!0)),n&&n()},R=(0,i.jsx)(eP,{id:c?void 0:s,showcaseId:r,onSuccess:()=>{y(!0)},disabled:E,children:d});return E?R:(0,i.jsxs)(i.Fragment,{children:[R,(0,i.jsx)(h.Ay,{open:g,onOpenChange:e=>{P||y(e)},title:"",description:"",contentClassName:"p-0",className:"max-w-3xl transition-all duration-300",showCrossClose:!0,children:(0,i.jsxs)(k.bL,{className:"flex max-h-[calc(100vh-40px)] flex-col p-6",value:m,onValueChange:x,children:[(0,i.jsxs)(k.B8,{className:"border-bg-border text-label-muted mb-6 flex gap-10 border-b text-base font-semibold","aria-label":"Share your model",children:[(null==o?void 0:o.includes("publish"))?null:(0,i.jsxs)(k.l9,{className:"data-[state=active]:border-accent-base data-[state=active]:text-accent-base -mb-px flex items-center justify-center gap-1 border-b border-transparent pr-2 pb-4 pl-1",value:"publish",children:[(0,i.jsx)(w.A,{stroke:2,className:"size-5"}),u("Workspace.Export.Publish")]}),(null==o?void 0:o.includes("share"))?null:(0,i.jsxs)(k.l9,{className:"data-[state=active]:border-accent-base data-[state=active]:text-accent-base relative -mb-px flex items-center justify-center gap-1 border-b border-transparent pr-2 pb-4 pl-1",value:"share",children:[(0,i.jsx)(N.A,{stroke:2,className:"size-5"}),u("Workspace.Export.Share")]})]}),(0,i.jsxs)(k.UC,{className:"relative flex h-full max-h-[576px] min-h-0 flex-col",value:"share",children:[c?(0,i.jsx)(eC.xu,{currentAnimationId:s}):(0,i.jsx)(eC.Xf,{currentTaskId:s}),(null==z?void 0:z.isForbiddenPublish)&&U&&(0,i.jsx)("div",{className:"bg-bg-modal-overlay absolute inset-0 z-10 flex items-center justify-center text-base backdrop-blur-sm",children:u("Team.ForbiddenPublish.Mask")})]}),(0,i.jsxs)(k.UC,{className:"relative flex h-full max-h-[576px] min-h-0 flex-col",value:"publish",children:[(0,i.jsx)(eT,{currentTaskId:s,onPublished:F,onUnpublished:F,isAnimation:c,isSubmitting:P,setIsSubmitting:I}),(null==z?void 0:z.isForbiddenPublish)&&(0,i.jsx)("div",{className:"bg-bg-modal-overlay absolute inset-0 z-10 flex items-center justify-center text-base backdrop-blur-sm",children:u("Team.ForbiddenPublish.Mask")})]})]})}),(0,i.jsx)(b.A,{isOpen:T,onClose:()=>{C(!1)},promotionCode:D})]})};function eD(e){let{taskId:s,showcaseId:a,size:t="md",className:l}=e,r=(0,S.c3)(),o=(0,d.n)(),{data:n}=(0,p.ZE)(a?null:s),{data:c}=(0,p.G2)(a?s:null),m=a?c:n,h=!!a,x=(null==m?void 0:m.mode)===j.nN.ImageTo3D&&(null==m?void 0:m.aiModel)!==j.jZ.Meshy4,b=eI.Share;return h||x||(b=void 0),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ez,{taskId:s,taskMode:null==m?void 0:m.mode,showcaseId:a,taskStatus:null==m?void 0:m.status,defaultTab:b,hiddenTabs:h?[eI.Publish]:[],children:(0,i.jsx)("div",{className:"w-full grow",children:(0,i.jsx)(u.default,{type:"secondary",size:t,block:!0,className:l,icon:(0,i.jsx)(N.A,{className:"size-5",stroke:1.5}),onClick:()=>{o("share_3d_models_intent",{position:"community_showcase_card"})},children:r("Workspace.Shared.WorkspaceToolbar.Share.Default")})})})})}function e_(e){var s,a;let{size:t="md",animationId:l,className:r}=e,o=(0,S.c3)(),n=(0,d.n)(),{data:c}=(0,D.Pt)(l),m=(null==c||null==(s=c.taskJson)?void 0:s.mode)===j.nN.ImageTo3D&&(null==c||null==(a=c.taskJson)?void 0:a.aiModel)!==j.jZ.Meshy4,h=eI.Share;return(m||(h=void 0),c)?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ez,{taskId:l,taskMode:null==c?void 0:c.taskJson.mode,taskStatus:j.FX.Succeeded,defaultTab:h,hiddenTabs:[eI.Publish],isAnimation:!0,children:(0,i.jsx)("div",{className:"grow",children:(0,i.jsx)(u.default,{type:"secondary",size:"md",block:!0,icon:(0,i.jsx)(N.A,{className:"size-5",stroke:1.5}),onClick:()=>{n("share_3d_models_intent",{position:"community_showcase_card"})},children:o("Workspace.Shared.WorkspaceToolbar.Share.Default")})})})}):(0,i.jsx)(u.default,{type:"secondary",size:t,block:!0,className:r,icon:(0,i.jsx)(N.A,{className:"size-5",stroke:1.5}),onClick:()=>{n("share_3d_models_intent",{position:"community_showcase_card"})},children:o("Workspace.Shared.WorkspaceToolbar.Share.Default")})}ez.displayName="ExportDialog-ForwardRef";var eW=a(10746),eM=a(36501),eU=a(43946),eE=a(97698),eF=a(54769),eR=a(4533),eO=a(79534),eZ=a(66599),eL=a(26545),eV=a(93759),eJ=a(34028),eB=a(66832);let eH=e=>{let{taskId:s,size:a="md",className:t}=e,l=(0,S.c3)(),{openDialog:r,dialogComponent:o}=(0,eB.E)({taskId:s,skipPatch:!0}),n=(0,d.n)();return(0,i.jsxs)("div",{className:"w-full grow",children:[(0,i.jsx)(u.default,{type:"secondary",size:a,block:!0,className:t,icon:(0,i.jsx)(N.A,{className:"size-5",stroke:1.5}),onClick:()=>{n("share_3d_models_intent",{position:"community_showcase_card"}),r()},children:l("Workspace.Shared.WorkspaceToolbar.Share.Default")}),o]})};var eq=a(28649),eK=a(89068),eG=a(89537);let eX=e=>{let{id:s,isV2:a,isLegacyAnimation:t,secret:l}=e,{taskDataV1:i,taskDataV2:r,animationData:o}=(e=>{let{taskId:s,isLegacyAnimation:a,isV2:t,secret:l}=e,{isPublic:i}=(0,eK.p)(),{data:r,isLoading:o}=(0,p.G2)(a||t?null:s,l),{data:n,isLoading:c}=(0,eG.G2)(t&&i?s:null,l),{data:d,isLoading:u}=(0,p.TH)(a?s:null),{data:m,isLoading:h}=(0,eG.ZE)(t&&!i?s:null);return{taskDataV1:r,taskDataV2:i?n:m,animationData:d,isLoading:o||c||u||h}})({taskId:s,isLegacyAnimation:t,isV2:a,secret:l}),n=r||i||o,c=!s||!n;(0,A.useEffect)(()=>{r&&(0,J._$)(r)},[r]);let{modelUrl:d,animationType:u,animationActions:m,quadJsonUrl:h,textureUrls:x,canPrint3DModel:b,canAddPlatform:f}=(0,eF.t)(r);if(i){var v,g;d=null==(v=i.result)?void 0:v.modelUrl,x=null==(g=i.result)?void 0:g.textureUrls}return o&&(u=o.artStyle,m=o.actions),{taskDataV1:i,taskDataV2:r,animationData:o,isEmpty:c,getKeyValue:e=>(null==r?void 0:r[e])||(null==o?void 0:o[e])||(null==i?void 0:i[e]),modelUrl:d,animationType:u,animationActions:m,quadJsonUrl:h,textureUrls:x,canAddPlatform:f,canPrint3DModel:b}},eY=e=>{var s,a;let{id:t,isV2:l,isLegacyAnimation:d,secret:m="",className:h,onClickComment:b}=e,v=(0,S.c3)(),{taskDataV2:p,isEmpty:g,getKeyValue:j,modelUrl:y,animationType:k,animationActions:w,quadJsonUrl:N,textureUrls:A,canAddPlatform:T,canPrint3DModel:C}=eX({id:t,isV2:l,isLegacyAnimation:d,secret:m}),{myInfo:P}=(0,f.Iy)(),I=j("showcaseId"),z=j("userId"),{data:_}=(0,D.Bw)(I||null),{data:W,mutate:M}=(0,eO.l)({showcaseId:I||""}),U=(0,eR.H)({taskId:null==p?void 0:p.id,taskMode:null==p?void 0:p.mode,popoverProps:{side:"top",align:"end",sideOffset:12,trigger:(0,i.jsx)(x.A,{title:v("Dashboard.Shared.Download"),children:(0,i.jsx)(eq.no,{size:"sm",type:"primary",children:(0,eU.Z)((null==p?void 0:p.downloads)||0)})})}}),E=(null==_?void 0:_.createdBy)||"",F=(null==P?void 0:P.userId)===E;return(0,i.jsxs)("div",{className:(0,eZ.cn)("border-bg-border bg-bg-base flex flex-col overflow-hidden rounded-xl border",h),children:[(0,i.jsx)("div",{className:"relative flex-1 overflow-hidden",children:!g&&(0,i.jsx)("div",{className:"absolute flex size-full flex-col items-center justify-center gap-0",children:(0,i.jsx)(eE.b,{forceSolidMode:(null==p?void 0:p.phase)==="generate",topology:null==p||null==(a=p.args)||null==(s=a.remesh)?void 0:s.topology,quadJsonUrl:N,modelUrl:y,textureUrls:A,animationType:k,animationActions:w,vertexCount:null==p?void 0:p.vertexCount,faceCount:null==p?void 0:p.faceCount})})}),I&&_&&!(null==p?void 0:p.workspaceId)&&(0,i.jsxs)("div",{className:"bg-bg-strong z-10 justify-between gap-2 space-y-2 self-stretch p-2 md:flex md:items-center md:space-y-0",children:[(0,i.jsx)(o.A,{size:"sm",userId:z,showcaseId:I}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)(x.A,{title:v("Dashboard.Community.Profile.Views"),children:(0,i.jsxs)("div",{className:"hidden items-center gap-1 pe-2 sm:flex",children:[(0,i.jsx)(eL.A,{className:"size-4",stroke:1.5}),(0,i.jsx)("span",{className:"text-xs font-medium",children:(0,eU.Z)(_.views)})]})}),(0,i.jsx)("div",{className:"leading-0",children:d?(0,i.jsx)(e_,{size:"sm",animationId:t,className:"font-medium"}):(0,D.Yv)(_)?(0,i.jsx)(eH,{size:"sm",taskId:t,className:"font-medium"}):(0,i.jsx)(eD,{size:"sm",taskId:t,showcaseId:I,className:"font-medium"})}),(0,i.jsx)(x.A,{title:v("Dashboard.Community.Comment"),asChild:!0,children:(0,i.jsx)(u.default,{size:"sm",type:"secondary",icon:(0,i.jsx)(eV.A,{size:16,stroke:1.5}),className:"font-medium",onClick:b,children:(0,eU.Z)(_.comments)})}),(0,i.jsx)(r.K,{showcaseId:I,onCollectionChange:()=>{M()},trigger:(0,i.jsx)(x.A,{title:v("Dashboard.Community.Collect"),asChild:!0,children:(0,i.jsx)(u.default,{size:"sm",type:"secondary",icon:(0,i.jsx)(eJ.A,{className:"size-4",stroke:1.5}),className:"gap-x-2 text-xs",block:!0,children:(0,eU.Z)(null==W?void 0:W.totalCollections)})})},I),(0,i.jsx)("div",{className:"border-bg-border mt-1 h-4 border-l"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.E,{size:"sm",type:"icon-secondary",showcaseData:_}),l&&(0,i.jsxs)(i.Fragment,{children:[T&&(0,i.jsx)(eM.D,{size:"sm",type:"icon-secondary",taskId:t,isSelfTask:F,canPrint3DModel:C}),(0,i.jsx)(eW.d,{size:"sm",type:"icon-secondary",isAnimation:(null==p?void 0:p.mode)==="animate",taskId:t})]})]}),(0,i.jsx)(eq.wX,{taskId:_.resultId,taskMode:_.mode,isSelfModel:F,isV2:l,popoverProps:{align:"end",alignOffset:-48},triggerProps:{type:"primary",children:(0,eU.Z)((null==W?void 0:W.totalDownloads)||0)},onDownloadCallback:()=>{M()}}),(0,i.jsx)("div",{className:"border-bg-border mt-1 hidden h-4 border-l sm:block"}),(0,i.jsx)(c.r,{className:"hidden sm:block",showcaseId:_.id})]})]}),(null==p?void 0:p.workspaceId)&&(0,i.jsxs)("div",{className:"bg-bg-strong z-10 justify-end gap-2 space-y-2 self-stretch p-2 md:flex md:items-center md:space-y-0",children:[(0,i.jsx)(x.A,{title:v("Dashboard.Community.Comment"),asChild:!0,children:(0,i.jsx)(u.default,{size:"sm",type:"secondary",icon:(0,i.jsx)(eV.A,{size:16,stroke:1.5}),className:"font-medium",onClick:b,children:(0,eU.Z)(p.comments)})}),l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"border-bg-border mt-1 h-4 border-l"}),T&&(0,i.jsx)(eM.D,{size:"sm",type:"icon-secondary",taskId:t,isSelfTask:!0,canPrint3DModel:C}),(0,i.jsx)(eW.d,{size:"sm",type:"icon-secondary",isAnimation:(null==p?void 0:p.mode)==="animate",taskId:t})]}),(0,i.jsx)("div",{className:"text-[0px]",children:U.popoverComponent})]})]})}},97698:(e,s,a)=>{a.d(s,{b:()=>y});var t=a(95155),l=a(12189),i=a(93800),r=a(80527),o=a(90738),n=a(24035),c=a(20651),d=a(48374),u=a(69095),m=a(58944),h=a(95944),x=a(18955),b=a(15239),f=a(12115);let v=e=>{let{riggingType:s,activePreviewName:a,setActivePreviewName:l,actions:i}=e,r=(0,f.useRef)(null),o=(0,x.c3)(),v=s===d.a$.Biped?n.t:n.u;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.N,{children:(0,t.jsx)(h.P.div,{ref:r,initial:{opacity:0,y:16},animate:{opacity:1,y:0},exit:{opacity:0,y:16},transition:{duration:.3,ease:"easeOut"},className:"border-bg-border bg-bg-sub max-w-[calc(100%-128px)] rounded-2xl border px-2 shadow-md",children:(0,t.jsx)(c.m,{children:(0,t.jsx)("div",{className:"flex items-start gap-2 px-2",children:null==i?void 0:i.map(e=>{var s,i;let{actionType:r}=e,n=r===a;return(0,t.jsxs)("div",{className:"group relative w-[56px] flex-none py-2",children:[(0,t.jsx)("button",{onMouseDown:e=>e.preventDefault(),onClick:()=>{null==l||l(r)},className:(0,u.A)("bg-bg-base-hover focus:ring-accent-base focus:ring-offset-bg-sub relative flex h-[56px] w-full flex-col items-center justify-center overflow-hidden rounded-xl border p-2 transition duration-100 ease-out focus:ring-2 focus:ring-offset-2 focus:outline-hidden active:opacity-70",{"border-bg-border hover:border-accent-secondary":!n,"border-accent-base":n}),children:(0,t.jsx)(b.default,{alt:"model",src:null!=(i=null==(s=v[r])?void 0:s.previewUrl)?i:"",className:"pointer-events-none absolute inset-0 size-full object-cover",unoptimized:!0,width:120,height:120})}),(0,t.jsx)("div",{className:(0,u.A)("flex flex-col pt-[2px] text-center text-[8px] font-medium","group-hover:text-label-base",{"text-accent-base":n,"text-label-muted":!n}),children:(0,t.jsx)("span",{children:o("Workspace.Rigging.PreviewAnimation."+r)})})]},r)})})})})})})};var p=a(81205),g=a(96034);let j=(0,a(75731).vt)((e,s)=>({activePreviewName:d.Gx.Walking})),y=e=>{let{forceSolidMode:s,topology:a,quadJsonUrl:n,modelUrl:c,textureUrls:d,animationType:u,animationActions:m,vertexCount:h,faceCount:x,modelViewerRef:b,enableDisplaySettings:y,enableEnvironmentSettings:k}=e,w=!!u,N=j(e=>e.activePreviewName),S=e=>{j.setState({activePreviewName:e})},{animationModelUrl:A,skeletonModelUrl:T}=(0,g.b)(null!=m?m:[],N);(0,f.useEffect)(()=>{let e=null==m?void 0:m[0];e&&S(e.actionType)},[m]);let C=(0,f.useRef)(null);return w&&m||!w&&c?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"bg-bg-base relative flex size-full min-h-0 grow flex-col items-center justify-center",ref:C,children:[(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(o.y,{textureUrls:d,enableRiggingDisplaySettings:w,enableWireframeMode:!w,enableDisplaySettings:y,enableEnvironmentSettings:k})}),(0,t.jsx)("div",{className:"relative min-h-0 w-full grow",children:(0,t.jsxs)(f.Suspense,{fallback:(0,t.jsx)("div",{className:"flex flex-col items-center justify-center gap-4",children:(0,t.jsx)(i.A,{type:"dots"})}),children:[w&&m&&(0,t.jsx)(p.A,{ref:b,mode:"animation-preview",HDRIKey:"default",skeletonModelUrl:T,animationModelUrl:A}),!w&&c&&(0,t.jsx)(p.A,{ref:b,modelUrl:c,quadJsonUrl:n,mode:"workspace",HDRIKey:"default",forceSolidMode:s,textureUrls:d,enableIncomingTextureOverride:!0}),(0,t.jsx)("div",{className:"absolute top-3 left-3",children:(0,t.jsx)(r.H,{topology:a,quadJsonUrl:n,vertexCount:h,faceCount:x})})]})}),(0,t.jsx)("div",{className:"absolute bottom-4 left-4 z-50 hidden md:block",children:(0,t.jsx)(l.T,{initialDelay:".4s"})}),(0,t.jsx)("div",{className:"absolute bottom-4 left-0 w-full space-y-4",children:(0,t.jsx)("div",{className:"flex w-full justify-center",children:w&&(0,t.jsx)(v,{actions:m,activePreviewName:N,setActivePreviewName:S,riggingType:u})})})]})}):null}}}]);